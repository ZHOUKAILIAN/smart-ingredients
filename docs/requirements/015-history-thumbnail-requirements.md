# 015-历史记录缩略图需求文档

## 元数据

| 字段 | 值 |
|------|-----|
| 文档编号 | 015-history-thumbnail |
| 标题 | 历史记录缩略图需求文档 |
| 版本 | 1.0 |
| 状态 | 草稿 |
| 创建日期 | 2026-01-26 |
| 更新日期 | 2026-01-26 |
| 作者 | Codex |

## 概述

### 目的
在历史记录列表中显示缩略图，帮助用户快速识别对应的图片，提高历史记录的可识别性。

### 范围
**包含内容**：
- 本地历史记录与云端历史记录列表展示缩略图
- 缩略图缺失或加载失败时的占位展示
- 本地历史记录中保存图片路径

**不包含内容**：
- 历史记录图片编辑、裁剪或导出
- 图片的再次上传或替换

### 利益相关者
- **用户**：更容易定位历史记录对应的图片
- **产品团队**：提升历史功能的可用性与满意度

## 功能需求

### 需求 1：历史记录缩略图展示
- **编号**: FR-015-001
- **优先级**: 高
- **描述**: 历史记录列表（本地与云端）每条记录显示对应图片的缩略图
- **验收标准**:
  - [ ] 历史记录列表中每条记录展示一张缩略图
  - [ ] 缩略图与记录信息对齐，点击记录仍可查看详情
  - [ ] 缩略图尺寸统一，避免列表视觉抖动

### 需求 2：本地历史记录保存图片路径
- **编号**: FR-015-002
- **优先级**: 高
- **描述**: 未登录用户的本地历史记录需要保存图片路径，用于缩略图展示
- **验收标准**:
  - [ ] 每条本地历史记录保存图片路径字段
  - [ ] 图片路径可用于构建可访问的缩略图链接
  - [ ] 对旧数据兼容：缺失路径时显示占位图

### 需求 3：缩略图降级处理
- **编号**: FR-015-003
- **优先级**: 中
- **描述**: 缩略图缺失或加载失败时显示占位图，避免空白
- **验收标准**:
  - [ ] 缩略图路径为空时显示占位图
  - [ ] 图片加载失败时自动切换为占位图
  - [ ] 占位图风格与历史记录卡片一致

## 非功能需求

### 性能
- 历史记录列表加载缩略图不影响页面首屏渲染
- 缩略图加载失败不阻塞列表渲染

### 可靠性
- 缩略图加载失败时不影响其他信息显示
- 本地历史记录缺失图片路径时不报错

## 用户故事

### 故事 1
- **作为** 需要回看历史记录的用户
- **我想要** 看到每条历史记录对应的缩略图
- **以便** 快速识别是哪张图片的分析结果

## 用例

### 用例 1：查看历史记录缩略图
- **参与者**: 用户
- **前置条件**: 用户已有历史记录
- **主流程**:
  1. 用户进入历史记录页面
  2. 系统加载历史记录列表
  3. 系统显示每条记录的缩略图与摘要信息
- **后置条件**: 用户可通过缩略图识别记录
- **备选流程**:
  - 3a. 缩略图加载失败时显示占位图

## 约束条件

### 技术约束
- 图片路径可能为相对路径，需要前端拼接完整 URL
- 本地存储空间有限，避免存储图片原始数据

## 依赖关系

### 内部依赖
- 历史记录数据结构（本地与云端）
- 图片上传返回的图片路径

### 外部依赖
- 服务器静态文件访问能力（/uploads）

## 成功指标

- 历史记录缩略图展示成功率 > 95%
- 历史记录列表用户点击率提升

## 待解决问题

| 问题 | 影响 | 负责人 | 状态 |
|------|------|--------|------|
| 缩略图的尺寸规范是否需要与设计稿对齐？ | 低 | 产品团队 | 开放 |

## 参考资料

- `docs/requirements/014-local-history-storage-requirements.md`

---

## 变更记录

| 版本 | 日期 | 作者 | 描述 |
|------|------|------|------|
| 1.0 | 2026-01-26 | Codex | 初始版本 |
