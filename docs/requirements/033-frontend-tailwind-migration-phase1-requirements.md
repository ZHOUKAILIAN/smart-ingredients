# 033-Frontend Tailwind 迁移（一期）需求

## 元数据

| 字段 | 值 |
|------|-----|
| 文档编号 | 033 |
| 标题 | Frontend Tailwind 迁移（一期）需求 |
| 版本 | 1.0 |
| 状态 | 实施中 |
| 创建日期 | 2026-02-26 |
| 更新日期 | 2026-02-26 |
| 作者 | Codex |

## 背景

当前 `frontend/` 样式为 Tailwind 类与自定义 CSS 混用，样式来源分散（`app.css`、`bottom-nav.css`、`figma-util.css`、组件局部类名），导致：
- 样式复用与一致性成本高；
- 页面改动需要同时维护 Rust 结构和多处 CSS；
- 新增页面时难以复用统一设计 token。

## 目标

- 一期仅迁移 `frontend/` 到“Tailwind 为主”的样式体系；
- 保留少量全局基础样式（reset、root 变量、动画/工具类、第三方兼容类）；
- 在不改变业务行为的前提下完成 UI 样式迁移。

## 范围

### 包含

1. 建立/完善 Tailwind 在 `frontend/` 的构建链路与扫描路径。
2. 将页面与组件中的主要视觉样式迁移到 Tailwind utility class。
3. 将可复用模式沉淀为 Tailwind 组合（`@layer components` 或少量全局工具类）。
4. 清理不再使用的自定义 CSS 规则。
5. 补充迁移说明文档（哪些样式保留全局、哪些必须用 Tailwind）。

### 不包含

1. `miniapp/` 的样式迁移。
2. 后端、接口、数据库、OCR/LLM 逻辑变更。
3. 对现有视觉稿做大规模重设计（仅允许等价样式迁移和必要微调）。

## 功能需求

### FR-033-001 Tailwind 主导样式体系
- **优先级**: 高
- **描述**: 前端页面/组件样式以 Tailwind 类为主表达。
- **验收标准**:
  - [x] 新增或改造后的页面样式主要由 Tailwind class 驱动。
  - [x] 关键布局/间距/色彩不依赖大量散落的自定义类名。

### FR-033-002 保留少量全局基础样式
- **优先级**: 高
- **描述**: 允许保留少量必要全局样式，避免过度 Tailwind 化带来维护负担。
- **验收标准**:
  - [x] 全局样式仅保留基础层（如 reset、变量、动画、第三方兼容）。
  - [x] 保留项在文档中有清单和理由。

### FR-033-003 分批迁移并可回滚
- **优先级**: 高
- **描述**: 按页面/组件批次迁移，保证每批可独立验证与回退。
- **验收标准**:
  - [x] 迁移分批方案明确（批次、文件范围、验证项）。
  - [x] 每批次完成后 `cargo check` 通过。

### FR-033-004 视觉与交互不回归
- **优先级**: 高
- **描述**: 保持页面行为与核心视觉层级稳定。
- **验收标准**:
  - [x] 关键流程页面（拍摄/OCR/结果/历史/社区）可正常访问和交互。（编译构建与结构巡检通过）
  - [x] 不出现明显布局错位、遮挡、不可点击问题。（基于本地代码巡检）

### FR-033-005 样式资产收敛
- **优先级**: 中
- **描述**: 清理冗余 CSS，降低样式维护复杂度。
- **验收标准**:
  - [x] 被 Tailwind 取代的规则已删除或标记废弃。
  - [x] 样式文件结构比迁移前更聚焦、更可解释。

## 非功能需求

### 可维护性
- 迁移后开发者可优先通过类名组合完成样式改动，减少“到处找 CSS 定义”。

### 一致性
- 颜色、圆角、阴影、间距优先采用统一 token（Tailwind theme 或变量映射）。

### 可验证性
- 每批迁移均可通过命令和手工路径复现验证结果。

## 约束

- 严格一期范围：仅 `frontend/`。
- 保持最小必要改动，不做与本需求无关重构。
- 先文档后实现，文档确认后再进入代码迁移。

## 成功标准

1. `frontend/` 达到“Tailwind 为主 + 少量全局样式”的目标。
2. `cargo check -p smart-ingredients-app` 通过。
3. `trunk build` 可通过（在本地 `NO_COLOR` 环境兼容前提下）。
4. 关键页面无明显样式和交互回归。

## 当前验证备注（2026-02-26）

1. `cargo check -p smart-ingredients-app` 通过（存在历史 warnings）。
2. `NO_COLOR=false trunk build` 通过（曾出现一次 wasm-bindgen stage 目录偶发错误，重跑成功）。
3. `docker compose up -d postgres redis backend` 失败：本机 Docker daemon 不可用，导致“本地服务健康检查 + 完整 API E2E”尚未完成。
