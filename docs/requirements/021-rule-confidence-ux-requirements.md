# 021-需求文档

## 元数据

| 字段 | 值 |
|------|-----|
| 文档编号 | 021-rule-confidence-ux |
| 标题 | 规则库扩展 + 可信度增强 + 解释性强化 需求文档 |
| 版本 | 1.0 |
| 状态 | 草稿 |
| 创建日期 | 2026-02-13 |
| 更新日期 | 2026-02-13 |
| 作者 | 小周 |

## 概述

### 目的
在 019/020 基础上扩展规则库覆盖面，提升可信度算法，并加强前端解释性，使结果更专业可信。

### 范围
- 扩展规则库：过敏原、人群标签（儿童/孕妇/慢病等）、高风险添加剂
- 可信度算法增强：多因素评分与回退策略
- 前端解释性强化：风险链路、证据来源、可视化展示

### 利益相关者
- 终端用户
- 产品/运营
- 研发/测试

## 功能需求

### 需求 1：规则库扩展
- **编号**: FR-001
- **优先级**: 高
- **描述**: 增加常见过敏原与敏感人群标签，补充高风险添加剂规则条目。
- **验收标准**:
  - [ ] 规则库包含常见过敏原与人群标签
  - [ ] 规则条目支持统一描述与风险等级

### 需求 2：可信度算法增强
- **编号**: FR-002
- **优先级**: 高
- **描述**: 可信度由多因素构成（命中规则、文本长度、OCR质量等），提供回退策略。
- **验收标准**:
  - [ ] 可信度等级可追溯到明确因素
  - [ ] OCR 低质量时可信度自动降级

### 需求 3：前端解释性强化
- **编号**: FR-003
- **优先级**: 中
- **描述**: 前端展示风险链路（成分→规则→人群影响）与证据来源。
- **验收标准**:
  - [ ] 规则命中可视化为风险链路
  - [ ] 可信度原因展示完整

## 非功能需求

### 性能
- 规则扩展不显著增加响应时间

### 可维护性
- 规则库可配置与可扩展

## 用户故事

### 故事 1
- **作为** 过敏或特殊人群用户
- **我想要** 清晰解释性与风险链路
- **以便** 快速判断是否可食用

## 用例

### 用例 1：规则命中说明
- **参与者**: 用户
- **前置条件**: OCR 完成
- **主流程**: 规则命中 → 可信度计算 → 前端解释展示
- **后置条件**: 用户理解风险来源

## 约束条件

### 技术约束
- 规则仍以 JSON 配置为主

## 依赖关系

### 内部依赖
- 规则引擎与前端展示模块

## 成功指标

- 规则命中覆盖率提升
- 用户对结果可信度的正反馈提升

## 待解决问题

| 问题 | 影响 | 负责人 | 状态 |
|------|------|--------|------|
| 人群标签定义范围 | 中 | 小周 | 开放 |

## 参考资料

- 019/020 需求文档

---

## 变更记录

| 版本 | 日期 | 作者 | 描述 |
|------|------|------|------|
| 1.0 | 2026-02-13 | 小周 | 初始版本 |
