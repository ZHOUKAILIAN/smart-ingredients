# 017-移动端 UI 精细化优化需求文档

## 元数据

| 字段 | 值 |
|------|-----|
| 文档编号 | 017-mobile-ui-refinement |
| 标题 | 移动端 UI 精细化优化需求文档 |
| 版本 | 1.0 |
| 状态 | 草稿 |
| 创建日期 | 2026-01-31 |
| 更新日期 | 2026-01-31 |
| 作者 | Claude + User |

## 概述

### 目的

通过在真实移动设备/模拟器上进行测试和调整,优化应用在移动端的视觉效果和用户体验。解决"在浏览器看起来正常,但在手机上显示异常"的问题。

### 背景

- 之前的 UI 开发主要基于浏览器预览
- 实际在移动设备上运行时发现了布局、字体、间距等问题
- 需要在真实设备环境下进行精细化调整

### 范围

**包含内容**:
- 在 Android 模拟器/真实设备上测试所有页面
- 修复移动端特有的 UI 问题
- 优化触摸交互体验
- 调整字体大小、间距、按钮尺寸等细节
- 确保在不同屏幕尺寸下的一致性

**不包含内容**:
- 新功能开发
- 后端 API 改动
- 架构重构

### 利益相关者

- **最终用户**: 获得更好的移动端使用体验
- **开发者**: 建立基于真实设备的 UI 开发流程

## 功能需求

### 需求 1: 移动端布局适配验证

- **编号**: FR-017-001
- **优先级**: 高
- **描述**: 在移动设备上验证所有页面的布局适配情况
- **验收标准**:
  - [ ] 所有页面在模拟器上正常显示
  - [ ] 页面内容不超出屏幕边界
  - [ ] 滚动区域正常工作
  - [ ] 固定定位元素(如底部导航栏)位置正确
  - [ ] 安全区域(Safe Area)处理正确

### 需求 2: 触摸交互优化

- **编号**: FR-017-002
- **优先级**: 高
- **描述**: 优化按钮、卡片等可点击元素的触摸体验
- **验收标准**:
  - [ ] 按钮最小触摸区域 ≥ 44x44 dp (Android 推荐)
  - [ ] 点击反馈清晰(视觉反馈/触觉反馈)
  - [ ] 相邻可点击元素间距合理
  - [ ] 滑动操作流畅无卡顿
  - [ ] 长按、双击等手势响应正常

### 需求 3: 字体与文本优化

- **编号**: FR-017-003
- **优先级**: 中
- **描述**: 调整字体大小、行高、字重,确保在移动设备上清晰可读
- **验收标准**:
  - [ ] 正文字体大小 ≥ 14sp (Android)
  - [ ] 标题层级清晰
  - [ ] 长文本自动换行
  - [ ] 文本颜色对比度符合 WCAG AA 标准
  - [ ] 中英文混排显示正常

### 需求 4: 间距与视觉层次优化

- **编号**: FR-017-004
- **优先级**: 中
- **描述**: 调整页面元素间距、边距,建立清晰的视觉层次
- **验收标准**:
  - [ ] 页面边距统一(通常 16dp)
  - [ ] 卡片/列表项内边距合理
  - [ ] 元素分组清晰
  - [ ] 视觉焦点明确
  - [ ] 空白区域运用得当

### 需求 5: 图片与图标显示优化

- **编号**: FR-017-005
- **优先级**: 中
- **描述**: 优化图片加载、缩放、图标显示
- **验收标准**:
  - [ ] 图片尺寸适配不同屏幕密度
  - [ ] 图标大小统一(24dp 或 48dp)
  - [ ] 图片加载状态显示(占位符/骨架屏)
  - [ ] 图片错误状态处理
  - [ ] 图片预览功能正常

### 需求 6: 输入控件优化

- **编号**: FR-017-006
- **优先级**: 中
- **描述**: 优化输入框、选择器等表单控件的移动端体验
- **验收标准**:
  - [ ] 输入框高度合理(≥ 48dp)
  - [ ] 键盘弹出时页面布局不错乱
  - [ ] 输入类型正确(数字键盘、邮箱键盘等)
  - [ ] 占位符文本清晰
  - [ ] 错误提示位置合理

### 需求 7: 加载与状态反馈优化

- **编号**: FR-017-007
- **优先级**: 高
- **描述**: 优化加载动画、Toast 提示等状态反馈
- **验收标准**:
  - [ ] 加载动画大小适中
  - [ ] Toast 提示位置合理(不遮挡重要内容)
  - [ ] 错误提示清晰易懂
  - [ ] 空状态页面友好
  - [ ] 加载时间过长有提示

### 需求 8: 页面切换与动画优化

- **编号**: FR-017-008
- **优先级**: 低
- **描述**: 优化页面切换动画、过渡效果
- **验收标准**:
  - [ ] 页面切换流畅(60fps)
  - [ ] 动画时长合理(200-300ms)
  - [ ] 避免不必要的动画
  - [ ] 动画方向符合用户预期
  - [ ] 支持动画禁用(可访问性)

## 非功能需求

### 性能

- 页面首次渲染时间 < 1s
- 交互响应时间 < 100ms
- 滚动帧率 ≥ 60fps
- 应用包体积增量 < 5MB

### 兼容性

- 支持 Android 8.0+ (API 26+)
- 支持屏幕尺寸: 4.7" - 6.7"
- 支持屏幕密度: mdpi - xxxhdpi
- 支持横竖屏切换(如适用)

### 可访问性

- 触摸目标最小 44x44 dp
- 文本对比度 ≥ 4.5:1 (WCAG AA)
- 支持系统字体缩放
- 颜色不是唯一的信息传达方式

### 可维护性

- UI 组件可复用
- 样式统一管理
- 响应式设计原则
- 代码注释清晰

## 用户故事

### 故事 1: 移动端浏览体验

- **作为** 移动端用户
- **我想要** 在手机上流畅浏览应用
- **以便** 获得与浏览器一致的使用体验

### 故事 2: 触摸操作

- **作为** 移动端用户
- **我想要** 轻松点击按钮和操作界面
- **以便** 避免误触和操作失败

### 故事 3: 内容阅读

- **作为** 移动端用户
- **我想要** 清晰阅读配料表分析结果
- **以便** 快速获取食品安全信息

## 用例

### 用例 1: 在模拟器上测试 UI

- **参与者**: 开发者
- **前置条件**:
  - Android 模拟器已启动
  - 应用已安装到模拟器
- **主流程**:
  1. 启动应用
  2. 逐页检查 UI 显示
  3. 测试各种交互操作
  4. 记录发现的问题
  5. 调整 CSS/组件代码
  6. 重新构建并测试
  7. 确认问题已修复
- **后置条件**: UI 在移动设备上显示正常
- **备选流程**:
  - 如果问题复杂,创建单独的测试页面进行调试

### 用例 2: 多设备适配测试

- **参与者**: 开发者
- **前置条件**:
  - 准备不同屏幕尺寸的模拟器配置
- **主流程**:
  1. 在小屏设备(4.7")上测试
  2. 在中屏设备(5.5")上测试
  3. 在大屏设备(6.7")上测试
  4. 对比不同设备上的显示效果
  5. 调整响应式布局
  6. 验证所有设备上的一致性
- **后置条件**: 应用在不同屏幕尺寸下均正常显示

## 约束条件

### 技术约束

- 使用 Tauri 2.x + Leptos 0.7.x 框架
- CSS 样式基于现有设计系统
- 不引入新的 UI 框架或库
- 保持与现有代码风格一致

### 业务约束

- 不改变现有功能逻辑
- 不影响现有用户数据
- 优化过程中应用保持可用

### 时间约束

- 迭代式优化,每次改动小而精
- 每次改动后立即在设备上验证

## 依赖关系

### 内部依赖

- 现有 UI 组件库
- 设计系统规范 (`docs/design/figma-design-system.md`)
- 现有样式文件 (`frontend/src/styles/`)

### 外部依赖

- Android SDK
- Android 模拟器或真实设备
- Tauri Android 构建工具链

## 成功指标

- **视觉一致性**: 移动端与设计稿匹配度 ≥ 95%
- **交互流畅度**: 无明显卡顿或延迟
- **问题修复率**: 发现的 UI 问题 100% 修复
- **用户满意度**: 移动端使用体验显著提升

## 测试设备配置

### 推荐模拟器配置

| 配置项 | 值 |
|--------|-----|
| 设备类型 | Pixel 6 / Pixel 6 Pro |
| Android 版本 | Android 13 (API 33) |
| 屏幕尺寸 | 6.4" / 6.7" |
| 分辨率 | 1080x2400 / 1440x3120 |
| 密度 | 420dpi / 560dpi |

### 测试场景

- 首次启动
- 拍照/选择图片
- OCR 识别
- 结果展示
- 历史记录浏览
- 个人中心
- 登录/注册

## 优化重点页面

### 高优先级

1. **拍照页面** (`capture.rs`): 相机预览、按钮布局
2. **结果页面** (`result.rs`): 配料卡片、健康评分
3. **历史页面** (`history.rs`): 列表布局、卡片间距

### 中优先级

4. **登录页面** (`login.rs`): 输入框、按钮
5. **个人中心** (`profile.rs`): 列表项、图标
6. **详情页面** (`detail.rs`): 文本排版、表格

### 低优先级

7. **加载页面** (`analyzing.rs`, `ocr.rs`): 加载动画
8. **汇总页面** (`summary.rs`): 卡片布局

## 待解决问题

| 问题 | 影响 | 负责人 | 状态 |
|------|------|--------|------|
| 是否需要支持平板布局? | 中 | 待定 | 开放 |
| 是否需要适配 iOS? | 低 | 待定 | 开放 |
| 是否需要深色模式优化? | 低 | 待定 | 开放 |

## 参考资料

- [Material Design - Touch targets](https://m3.material.io/foundations/interaction/gestures/touch-targets)
- [Android Design Guidelines](https://developer.android.com/design)
- [WCAG 2.1 Accessibility Guidelines](https://www.w3.org/WAI/WCAG21/quickref/)
- 项目设计系统: `docs/design/figma-design-system.md`
- 之前的 UI 优化需求: `docs/requirements/005-ui-optimization-requirements.md`

---

## 变更记录

| 版本 | 日期 | 作者 | 描述 |
|------|------|------|------|
| 1.0 | 2026-01-31 | Claude + User | 初始版本 |
